<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>PubNub DataSync Test</title>
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="dist/css/styles.css" rel="stylesheet">
</head>

<script src="https://cdn.pubnub.com/pubnub.min.js"></script>
<script src="https://cdn.pubnub.com/pubnub-crypto.min.js"></script>
<script src="dist/js/pubnub-sync.js"></script>
<script>(function(){

    var settings = {
        publish_key   : 'pub-5ad63a7a-0c72-4b86-978d-960dcdb971e1'
    ,   subscribe_key : 'sub-459a5e4a-9de6-11e0-982f-efe715a9b6b8'
    ,   secret_key    : 'sec-fa847381-dcdb-4bcf-a8aa-7b812c390441'
    ,   cipher        : 'ODgwNDsmIzczMDustKOiJiM4NzM0O7aqSDNh2mig'
    ,   limit         : 5000 // max binlog replay
    ,   ssl           : true
    };

    // OPEN DB CONNECTION
    var db = PUBNUB.sync( 'db1', settings );

    // ON CREATE EVENT
    db.on.create(function(item) {
        log(item);
    });

    // ON UPDATE EVENT
    db.on.update(function(item) {
        log(item);
    });

    // ON DELETE EVENT
    db.on.delete(function(item) {
        log(item);
    });

    // CREATE
    var obj1 = db.create({ key : 'value1' })
    ,   obj2 = db.create({ key : 'value2' })
    ,   obj3 = db.create({ foo : 'bar'    });

    // READ and FIND
    var obj4     = db.read(id1);
    var obj_list = db.find({ key : 'value1' });
    log(obj4);
    log(obj_list);

    // UPDATE
    obj2.update({ key : 'other1' });
    obj3.update({ key : 'other2' });

    // DELETE
    obj3.delete();

    // PRINT ALL OBJECTS
    log(db());
    log(db.all());

    function log(data) {
        var body = document.getElementsByTagName('body')[0];
        body.innerHTML = JSON.stringify(data) + '<br>' + body.innerHTML;
    }


})();</script>

</body>
</html>
